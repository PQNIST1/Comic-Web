<%- include("layout/header.ejs") %>
<div class=".container-fluid p-0 main">
  <div class=" ">
<div
id="carouselExampleCaptions"
class="carousel slide"
data-ride="carousel"
>
<ol class="carousel-indicators">
  <li
    data-target="#carouselExampleCaptions"
    data-slide-to="0"
    class="active"
  ></li>
  <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
  <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
</ol>
<div class="carousel-inner">
  <div class="carousel-item active">
    <a href=""><img src="/images/hình 3.png" class="w-100" alt="..."/></a>
    <div class="carousel-caption d-none d-md-block"></div>
  </div>
  <div class="carousel-item">
    <a href=""><img
      src="/images/hình 2.png"
      class="d-block w-100"
      alt="..."
    /></a>
    
    <div class="carousel-caption d-none d-md-block"></div>
  </div>
  <div class="carousel-item">
    <a href=""><img src="/images/hình 1.jpg" class="w-100" alt="..." /></a>
    
    <div class="carousel-caption d-none d-md-block"></div>
  </div>
</div>
<button
  class="carousel-control-prev"
  type="button"
  data-target="#carouselExampleCaptions"
  data-slide="prev"
></button>
<button
  class="carousel-control-next"
  type="button"
  data-target="#carouselExampleCaptions"
  data-slide="next"
></button>
</div>
<div class="container body-con">
<div class="error" style="color: #004085; background-color: #cce5ff;">
  <p>Đứt cáp quang biển nên hình đang load chậm mong các bạn thông cảm.</p>
</div>
<div class="body-text">
  

  <div class="banner-left">
    <div class="text-1">
      <div style="color: #606686;">
        <i style="color:#ff3e83a3;" class="fa-solid fa-calendar-day"></i>
        <span>Cập Nhật Gần Đây</span>
        <i class="fa-solid fa-caret-down down"></i>
      </div>
    </div>
    <div class="container-grid-1">
      <% function formatNumberWithCommas(number) {
        return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      } %>
      <% comics.forEach((comic) => { %>
      <div class="item info" style="width: 165px; height: 295px;">
        <div class="card-1" style="width: 165px; height: 295px;">
          <div class="comic">
            <a href="/comic/<%= comic._id %>">
              <img src="<%= comic.image %>" class="card-img-top" alt="..." />
            </a>
          </div>
          <div class="comic-info">
            <span class="item-info">
              <div class="left"><i class="fa-regular fa-eye"></i>
                <%= formatNumberWithCommas(comic.views) %>
              </div>
              <div class="right">
                <i class="fa-solid fa-person-walking"></i>
                <%= comic.followers.length %>
              </div>
            </span>
          </div>
          <div class="title" style="width: 165px; height: 35px;">
            <a href="/comic/<%= comic._id %>"><%= comic.name %></a>
          </div>
          <div class="chapter">
            <p>Chương</p>
            <% const reversedChapters = comic.chapters.slice(-2).reverse() %>
            <% reversedChapters.forEach((chapter) => { %>
              <a href="/comic/chapter/<%= chapter._id %>"><%= chapter.chapterNumber %></a>
            <% }); %>
        </div>
        </div>
      </div>
      <% }); %>
    </div>
    <div class="xem-them">
      <a href="/list?type=recently-updated">
        <h6>Xem Thêm</h6>
        <i class="fa-solid fa-caret-right right"></i>
      </a>

    </div>

    <div class="text-2">
      <div style="color: #606686;">
        <i style="color:#ff3e83a3;" class="fa-solid fa-thumbs-up"></i>
          <span>Truyện đề xuất</span>
        <i class="fa-solid fa-caret-down down1"></i>
      </div>
    </div>
    <div class="container-grid-2">
      <% comicsView.forEach((comic) => { %>
      <div class="item info" style="width: 165px; height: 295px;">
        <div class="card-1" style="width: 165px; height: 295px;">
          <div class="comic">
            <a href="/comic/<%= comic._id %>">
              <img src="<%= comic.image %>" class="card-img-top" alt="..." />
            </a>
          </div>
          <div class="comic-info">
            <span  class="item-info">
              <div class="left"><i class="fa-regular fa-eye"></i>
                <%= formatNumberWithCommas(comic.views) %>
              </div>
              <div class="right">
                <i class="fa-solid fa-person-walking"></i>
                <%= comic.followers.length %>
              </div>
            </span>
          </div>
          <div class="title" style="width: 165px; height: 35px;">
            <a href="/comic/<%= comic._id %>"><%= comic.name %></a>
          </div>
          <div class="chapter">
            <p>Chương</p>
            <% const reversedChapters = comic.chapters.slice(-2).reverse(); %>
            <% reversedChapters.forEach((chapter) => { %>
              <a href="/comic/chapter/<%= chapter._id %>"><%= chapter.chapterNumber %></a>
            <% }); %>
        </div>
        </div>
      </div>
      <% }); %>
    </div>
    <div class="xem-them1">
      <a href="/list?type=newest">
        <h6>Xem Thêm</h6>
        <i class="fa-solid fa-caret-right right"></i>
      </a>

    </div>
    <div class="text-3">
      <div style="color: #606686;">
        <i  style="color:#ff3e83a3;" class="fa-solid fa-newspaper"></i>
          <span>Truyện mới</span>
        <i class="fa-solid fa-caret-down down2"></i>
      </div>
    </div>
    <div class="container-grid-3">
      <% comicsNew.forEach((comic) => { %>
      <div class="item info" style="width: 165px; height: 295px;">
        <div class="card-1" style="width: 165px; height: 295px;">
          <div class="comic">
            <a href="/comic/<%= comic._id %>">
              <img src="<%= comic.image %>" class="card-img-top" alt="..." />
            </a>
          </div>
          <div class="comic-info">
            <span class="item-info">
              <div class="left"><i class="fa-regular fa-eye"></i>
                <%= formatNumberWithCommas(comic.views) %>
              </div>
              <div class="right">
                <i class="fa-solid fa-person-walking"></i>
                <%= comic.followers.length %>
              </div>
            </span>
          </div>
          <div class="title" style="width: 165px; height: 35px;">
            <a href="/comic/<%= comic._id %>"><%= comic.name %></a>
          </div>
          <div class="chapter">
            <p>Chương</p>
            <% const reversedChapters = comic.chapters.slice(-2).reverse(); %>
            <% reversedChapters.forEach((chapter) => { %>
              <a href="/comic/chapter/<%= chapter._id %>"><%= chapter.chapterNumber %></a>
            <% }); %>
        </div>
        </div>
      </div>
      <% }); %>
    </div>
    <div class="xem-them2">
      <a href="/list?type=most-viewed">
        <h6>Xem Thêm</h6>
        <i class="fa-solid fa-caret-right right"></i>
      </a>

    </div>
  </div>
  <div class="banner-right">
    <% if(user) { %>
    <% if (comicss.length > 0) { %>
      <div class="banner-history">
        <div class="history">
          <i style="color:#ff3e83a3;" class="fa-solid fa-person-walking"></i>
          <span>Theo Dõi Gần Đây</span>
          <a href="/follow-comic"><i class="fa-solid fa-angles-right hi"></i></a>
        </div>
        <% comicss.forEach(comic => { %>
              <div class="history-comic">
                <div class="mini-pic">
                  <a href="/comic/<%= comic.comic._id %>"><img src="<%= comic.comic.image %>" alt=""></a>
                </div>
                <div class="mini-content">
                  <a href="/comic/<%= comic.comic._id %>"><%= comic.comic.name %></a>
                  <br>
                  <a href="/comic/chapter/<%= comic.comic.chapters.slice(-1)[0]._id  %>">Chương <%= comic.comic.chapters.length %></a>
                </div>
              </div>
        <% }); %>
      </div>
      <% } %>
      <% } %>
    <% if (comicList.length > 0) { %>
    <div class="banner-history">
      <div class="history">
        <i style="color:#ff3e83a3;" class="fa-solid fa-clock-rotate-left"></i>
        <span>Lịch Sử Đọc Truyện</span>
        <a href="/history"><i class="fa-solid fa-angles-right hi"></i></a>
      </div>
      <% comicList.forEach(comic => { %>
            <div class="history-comic">
              <div class="mini-pic">
                <a href="/comic/<%= comic.comicId %>"><img src="<%= comic.image %>" alt=""></a>
              </div>
              <div class="mini-content">
                <a href="/comic/<%= comic.comicId %>"><%= comic.name %></a>
                <br>
                <a href="/comic/chapter/<%= comic.lastReadChapter %>">Chương <%= comic.chapterNumber %></a>
              </div>
            </div>
      <% }); %>
    </div>
    <% } %>
    <div class="famous">
      <i  style="color:#ff3e83a3;" class="fa-solid fa-star"></i>
        <span>Truyện Hay</span>
    </div>   
    <div class="banner-topic">
      <div class="tab-content">
        <% comicsView.forEach((comic) => { %>
        <div class="item-rank">
          <a href="/comic/<%= comic._id %>">
          <%= comic.name %></a>
        </div>
        <% }); %>
      </div>
    </div>
  </div>
  
</div>
</div>

</div>
</div>

<script
src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
crossorigin="anonymous"
></script>
<script
src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
crossorigin="anonymous"
></script>
<script
src="https://kit.fontawesome.com/4737b3d998.js"
crossorigin="anonymous"
></script>
<script src="/js/index.js"></script>
</body>


<%- include("layout/footer.ejs") %>

